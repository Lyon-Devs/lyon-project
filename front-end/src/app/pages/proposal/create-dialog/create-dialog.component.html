<h1 mat-dialog-title>{{this.createForm ? 'Novo' : 'Atualizar'}} proposta <button mat-icon-button
        [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
        <mat-icon>more_vert</mat-icon>
    </button></h1>

<mat-menu #menu="matMenu">
    <button mat-menu-item (click)="createClient()">
        <mat-icon>person_add</mat-icon>
        <span>Novo cliente</span>
    </button>
    <button mat-menu-item (click)="createBuyer()">
        <mat-icon>face</mat-icon>
        <span>Novo comprador</span>
    </button>
</mat-menu>
<div mat-dialog-content>
    <mat-vertical-stepper [linear]="false" #stepper>
        <mat-step [stepControl]="formBasic">
            <form  [formGroup]="formBasic">
                <ng-template matStepLabel>Informações básicas</ng-template>
                <div class="two-col">
                    <mat-form-field appearance="outline">
                        <mat-label>Cliente</mat-label>
                        <mat-select formControlName="client_id">
                            <mat-option>None</mat-option>
                            <mat-option [value]="client.id" *ngFor="let client of clients">{{client.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Cod. solicitação</mat-label>
                        <input matInput required formControlName="number_client_request">
                    </mat-form-field>
                </div>
                <div class="two-col">
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Comprador</mat-label>
                        <mat-select formControlName="buyer_id" required>
                            <mat-option>None</mat-option>
                            <mat-option [value]="buyer.id" *ngFor="let buyer of buyers">{{buyer.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Data solicitação</mat-label>
                        <input matInput [matDatepicker]="picker" formControlName="date_request">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class="two-col">
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Tipo de serviço</mat-label>
                        <mat-select formControlName="acting_branch_id" required>
                            <mat-option>None</mat-option>
                            <mat-option [value]="type.id" *ngFor="let type of types">
                                {{type.unity_business}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
        <mat-step [stepControl]="formTec" optional="true">
            <form [formGroup]="formTec">
                <ng-template matStepLabel>Proposta técnica</ng-template>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Data entrega</mat-label>
                    <input matInput [matDatepicker]="pickerTec" #dateTec formControlName="date_delivery_technique_proposal">
                    <mat-datepicker-toggle matSuffix [for]="pickerTec"></mat-datepicker-toggle>
                    <mat-datepicker #pickerTec></mat-datepicker>
                </mat-form-field>
                <ng-template matStepLabel>Responsável aréa Técnica</ng-template>
                <!-- <mat-checkbox class="example-margin" *ngFor="let user of this.userListTec"></mat-checkbox> -->
                <div class="list-users" *ngIf="dateTec.value">
                    <div class="title"> Usuários</div>
                    <ul>
                        <li *ngFor="let user of this.userListTec">
                            <mat-checkbox (change)="addOrRemoveTec($event, user)">
                                {{user.name}}
                            </mat-checkbox>
                        </li>
                    </ul>
                </div>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
        <mat-step [stepControl]="formCom" optional>
            <form [formGroup]="formCom">
                <ng-template matStepLabel>Proposta comercial</ng-template>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Data entrega</mat-label>
                    <input matInput [matDatepicker]="pickerCom" #dateCom formControlName="date_delivery_comercial_proposal">
                    <mat-datepicker-toggle matSuffix [for]="pickerCom"></mat-datepicker-toggle>
                    <mat-datepicker #pickerCom></mat-datepicker>
                </mat-form-field>

                <ng-template matStepLabel>Responsável aréa Comercial</ng-template>
                <div class="list-users" *ngIf="dateCom.value">
                    <div class="title"> Usuários</div>
                    <ul>
                        <li *ngFor="let user of this.userListCom">
                            <mat-checkbox (change)="addOrRemoveCom($event, user)">
                                {{user.name}}
                            </mat-checkbox>
                        </li>
                    </ul>
                </div>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
       
        <mat-step [stepControl]="formSummaryScope">
            <form [formGroup]="formSummaryScope">
                <ng-template matStepLabel>Escopo resumido</ng-template>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Escopo resumido</mat-label>
                    <textarea matInput required rows="3" formControlName="summary_scope"></textarea>
                </mat-form-field>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
       
        <mat-step [stepControl]="formScope">
            <form [formGroup]="formScope">
                <ng-template matStepLabel>Escopo</ng-template>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Escopo</mat-label>
                    <textarea matInput required rows="25" formControlName="scope"></textarea>
                </mat-form-field>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
        <mat-step [stepControl]="formExe">
            <form [formGroup]="formExe">
                <ng-template matStepLabel>Execução</ng-template>
                <div class="two-col">
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Em meses</mat-label>
                        <input matInput type="number" required formControlName="months_exec">
                    </mat-form-field>
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Local</mat-label>
                        <input matInput required formControlName="place_to_deploys_services">
                    </mat-form-field>
                </div>
                <div class="two-col">
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Data visita técnica</mat-label>
                        <input #dateTecVis matInput [matDatepicker]="dateTechniqueVisit" formControlName="date_technique_visit">
                        <mat-datepicker-toggle matSuffix [for]="dateTechniqueVisit"></mat-datepicker-toggle>
                        <mat-datepicker #dateTechniqueVisit></mat-datepicker>
                    </mat-form-field>
                    <mat-form-field appearance="outline" fullWidth *ngIf="dateTecVis.value">
                        <mat-label>Hora</mat-label>
                        <input matInput type="text" required mask="99:99" formControlName="time_technique_visit">
                    </mat-form-field>
                    
                </div>
                <mat-form-field appearance="outline" fullWidth *ngIf="dateTecVis.value">
                    <mat-label>Local visita técnica</mat-label>
                    <input matInput type="text" formControlName="local_technique_visit">
                </mat-form-field>
                <mat-form-field appearance="outline" fullWidth *ngIf="dateTecVis.value">
                    <mat-label>Detalhes visita técnica</mat-label>
                    <textarea matInput rows="5" formControlName="details_technique_visit"></textarea>
                </mat-form-field>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
        <mat-step [stepControl]="formDeploy">
            <form [formGroup]="formDeploy">
                <ng-template matStepLabel>Prestação de serviço</ng-template>
                <div class="two-col">
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Data confirm. participação</mat-label>
                        <input  matInput [matDatepicker]="dateCon" formControlName="deadline_date_confirme">
                        <mat-datepicker-toggle matSuffix [for]="dateCon"></mat-datepicker-toggle>
                        <mat-datepicker #dateCon></mat-datepicker>
                    </mat-form-field>
                    <mat-form-field appearance="outline" fullWidth>
                        <mat-label>Hora</mat-label>
                        <input matInput type="text" mask="99:99" formControlName="deadline_time_confirme">
                    </mat-form-field>
                </div>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Histograma Médio</mat-label>
                    <input matInput required formControlName="medium_histogram">
                </mat-form-field>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Anexos</mat-label>
                    <ngx-mat-file-input multiple (change)="uploadDocument($event)"></ngx-mat-file-input>
                </mat-form-field>
                <mat-form-field appearance="outline" fullWidth>
                    <mat-label>Considerações finais</mat-label>
                    <textarea matInput  formControlName="observations"></textarea>
                </mat-form-field>
                <div>
                    <button mat-button matStepperPrevious>Back</button>
                    <button mat-button matStepperNext>Next</button>
                </div>
            </form>
        </mat-step>
        <mat-step>
            <ng-template matStepLabel>Done</ng-template>
            <p>You are now done.</p>
            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button (click)="stepper.reset()">Reset</button>
                <button mat-button (click)="onSubmit()">Criar</button>
            </div>
        </mat-step>
    </mat-vertical-stepper>




</div>
<div mat-dialog-actions>
    <button mat-button (click)="onNoClick()">cancelar</button>
    <!-- <button mat-button cdkFocusInitial (click)="onSubmit()" [disabled]="!formType.valid" color="primary">salvar</button> -->
</div>